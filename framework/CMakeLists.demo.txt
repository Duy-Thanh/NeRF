cmake_minimum_required(VERSION 3.16)
project(DAF_Production)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Find required packages
find_package(PkgConfig REQUIRED)
pkg_check_modules(HIREDIS REQUIRED hiredis)
find_package(OpenSSL REQUIRED)

# Include directories
include_directories(src/common)
include_directories(src/storage)

# Common library
add_library(daf_common STATIC
    src/common/daf_utils.cpp
    src/common/plugin_loader.cpp
    src/storage/redis_client_production.cpp
)

target_link_libraries(daf_common
    ${HIREDIS_LIBRARIES}
    OpenSSL::SSL
    OpenSSL::Crypto
)

target_include_directories(daf_common PUBLIC
    ${HIREDIS_INCLUDE_DIRS}
)

target_link_directories(daf_common PUBLIC
    ${HIREDIS_LIBRARY_DIRS}
)

# Simple demo executable
add_executable(demo_app
    src/storage/redis_client_production.cpp
)

target_link_libraries(demo_app
    ${HIREDIS_LIBRARIES}
    OpenSSL::SSL
    OpenSSL::Crypto
    pthread
)

target_include_directories(demo_app PUBLIC
    ${HIREDIS_INCLUDE_DIRS}
)